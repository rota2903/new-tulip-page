<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>TULIP 1</title>
</head>
<body>
  <h1>TULIP 1</h1>

  <!-- WhatsApp Booking Button -->
  <a href="https://wa.me/6011112231979?text=Hi, I'd like to book TULIP 1" 
     style="display:block;background:#25D366;color:white;text-align:center;padding:15px;
            margin:20px 0;border-radius:5px;text-decoration:none;font-size:18px;font-weight:bold;">
     ğŸ“± Book via WhatsApp
  </a>

  <!-- Image Gallery -->
  <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:10px;">
    <img src="img1.jpg" style="width:100%;border-radius:8px;">
    <img src="img2.jpg" style="width:100%;border-radius:8px;">
    <img src="img3.jpg" style="width:100%;border-radius:8px;">
    <img src="img4.jpg" style="width:100%;border-radius:8px;">
    <img src="img5.jpg" style="width:100%;border-radius:8px;">
    <img src="img6.jpg" style="width:100%;border-radius:8px;">
  </div>

  <h2>ğŸ“… Availability Calendar</h2>
  <div id="calendar">Loading...</div>

  <!-- Admin Panel -->
  <div id="adminPanel">
    <h2>ğŸ” Admin Login</h2>
    <input type="password" id="adminPass" placeholder="Enter Password" />
    <button onclick="checkPassword()">Login</button>
    <div id="adminContent" style="display:none;margin-top:20px;">
      <h3>âœ… Approved Bookings</h3>
      <div id="approvedList"></div>
      <p><button onclick="logout()">Logout</button></p>
    </div>
  </div>

<script>
const ADMIN_PASSWORD = "9TulipsCH";
const BIN_FILE = "unit1.json";

let isAdminMode = false;
let bookings = [];

async function loadBookings() {
  try {
    const res = await fetch(BIN_FILE + "?t=" + Date.now());
    bookings = await res.json();
  } catch (e) {
    bookings = [];
  }
  renderCalendar();
}

function renderCalendar() {
  const calendar = document.getElementById("calendar");
  calendar.innerHTML = "";
  const today = new Date();
  const booked = new Set(bookings.map(d => d.date));

  for (let m = 0; m < 3; m++) {
    const monthDate = new Date(today.getFullYear(), today.getMonth() + m, 1);
    const month = monthDate.getMonth();
    const year = monthDate.getFullYear();
    const days = new Date(year, month+1, 0).getDate();
    const startDay = new Date(year, month, 1).getDay();

    let table = "<table border=1 style='width:100%;text-align:center;margin-bottom:20px;'>";
    table += "<tr><th colspan=7>" + monthDate.toLocaleString('default', {month:'long'}) + " " + year + "</th></tr>";
    table += "<tr><th>Su</th><th>Mo</th><th>Tu</th><th>We</th><th>Th</th><th>Fr</th><th>Sa</th></tr><tr>";

    for (let i=0;i<startDay;i++) table += "<td></td>";

    for (let d=1; d<=days; d++) {
      let dateStr = year + "-" + String(month+1).padStart(2,"0") + "-" + String(d).padStart(2,"0");
      let cls = booked.has(dateStr) ? "style='background:#3498db;color:white;'" : "style='background:#2ecc71;color:white;'";
      table += "<td "+cls+">"+d+"</td>";
      if ((d+startDay)%7===0) table+="</tr><tr>";
    }
    table += "</tr></table>";
    calendar.innerHTML += table;
  }
}

function checkPassword() {
  const pass = document.getElementById("adminPass").value;
  if (pass === ADMIN_PASSWORD) {
    isAdminMode = true;
    document.getElementById("adminPass").style.display="none";
    document.querySelector("#adminPanel button").style.display="none";
    document.getElementById("adminContent").style.display="block";
    loadApproved();
  } else alert("Wrong password");
}

function logout() {
  isAdminMode = false;
  document.getElementById("adminPass").style.display="block";
  document.getElementById("adminPass").value="";
  document.querySelector("#adminPanel button").style.display="inline-block";
  document.getElementById("adminContent").style.display="none";
}

function loadApproved() {
  const list = document.getElementById("approvedList");
  list.innerHTML = bookings.map(b => `<p>ğŸ“… ${b.date}</p>`).join("");
}

loadBookings();
</script>
</body>
</html>
